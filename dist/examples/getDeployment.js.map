{"version":3,"file":"getDeployment.js","names":["_index","require","_nod3Connect","_rskUtils","url","process","env","address","argv","highBlock","help","isAddress","nod3","nod3Connect","console","log","search","code","eth","getCode","parseInt","Error","bcsearch","BcSearch","res","deploymentTx","toLowerCase","err","error","exit","msg"],"sources":["../../src/examples/getDeployment.js"],"sourcesContent":["import { BcSearch } from '../index'\nimport { nod3Connect } from '../lib/nod3Connect'\nimport { isAddress } from '@rsksmart/rsk-utils'\n\nconst url = process.env['URL'] || 'http://localhost:4444'\nconst address = process.argv[2]\nconst highBlock = process.argv[3]\n\nif (!address) help()\nif (!isAddress(address)) help(`Invalid address \"${address}\"`)\n\nconst nod3 = nod3Connect(url)\n\nconsole.log(`Searching in node: ${url}`)\nsearch(address, highBlock)\n\nasync function search (address, highBlock) {\n  try {\n    highBlock = highBlock || 'latest'\n    const code = await nod3.eth.getCode(address, highBlock)\n    if (!parseInt(code)) {\n      throw new Error(`The address ${address} has no code at block ${highBlock}`)\n    }\n    const bcsearch = BcSearch(nod3)\n    let res = await bcsearch.deploymentTx(address.toLowerCase(), { highBlock })\n    console.log(res)\n  } catch (err) {\n    console.error(err)\n    process.exit(9)\n  }\n}\n\nfunction help (msg) {\n  if (msg) console.log(`${msg}`)\n  console.log('Usage:')\n  console.log(`node ${process.argv[1]} address [highestBlock]`)\n  console.log()\n  console.log(`Set environment variable URL to change node url`)\n  console.log(`Example: export URL=http://localhost:4444`)\n  process.exit(0)\n}\n"],"mappings":"aAAA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,YAAA,GAAAD,OAAA;AACA,IAAAE,SAAA,GAAAF,OAAA;;AAEA,MAAMG,GAAG,GAAGC,OAAO,CAACC,GAAG,CAAC,KAAK,CAAC,IAAI,uBAAuB;AACzD,MAAMC,OAAO,GAAGF,OAAO,CAACG,IAAI,CAAC,CAAC,CAAC;AAC/B,MAAMC,SAAS,GAAGJ,OAAO,CAACG,IAAI,CAAC,CAAC,CAAC;;AAEjC,IAAI,CAACD,OAAO,EAAEG,IAAI,CAAC,CAAC;AACpB,IAAI,CAAC,IAAAC,mBAAS,EAACJ,OAAO,CAAC,EAAEG,IAAI,CAAE,oBAAmBH,OAAQ,GAAE,CAAC;;AAE7D,MAAMK,IAAI,GAAG,IAAAC,wBAAW,EAACT,GAAG,CAAC;;AAE7BU,OAAO,CAACC,GAAG,CAAE,sBAAqBX,GAAI,EAAC,CAAC;AACxCY,MAAM,CAACT,OAAO,EAAEE,SAAS,CAAC;;AAE1B,eAAeO,MAAMA,CAAET,OAAO,EAAEE,SAAS,EAAE;EACzC,IAAI;IACFA,SAAS,GAAGA,SAAS,IAAI,QAAQ;IACjC,MAAMQ,IAAI,GAAG,MAAML,IAAI,CAACM,GAAG,CAACC,OAAO,CAACZ,OAAO,EAAEE,SAAS,CAAC;IACvD,IAAI,CAACW,QAAQ,CAACH,IAAI,CAAC,EAAE;MACnB,MAAM,IAAII,KAAK,CAAE,eAAcd,OAAQ,yBAAwBE,SAAU,EAAC,CAAC;IAC7E;IACA,MAAMa,QAAQ,GAAG,IAAAC,eAAQ,EAACX,IAAI,CAAC;IAC/B,IAAIY,GAAG,GAAG,MAAMF,QAAQ,CAACG,YAAY,CAAClB,OAAO,CAACmB,WAAW,CAAC,CAAC,EAAE,EAAEjB,SAAS,CAAC,CAAC,CAAC;IAC3EK,OAAO,CAACC,GAAG,CAACS,GAAG,CAAC;EAClB,CAAC,CAAC,OAAOG,GAAG,EAAE;IACZb,OAAO,CAACc,KAAK,CAACD,GAAG,CAAC;IAClBtB,OAAO,CAACwB,IAAI,CAAC,CAAC,CAAC;EACjB;AACF;;AAEA,SAASnB,IAAIA,CAAEoB,GAAG,EAAE;EAClB,IAAIA,GAAG,EAAEhB,OAAO,CAACC,GAAG,CAAE,GAAEe,GAAI,EAAC,CAAC;EAC9BhB,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;EACrBD,OAAO,CAACC,GAAG,CAAE,QAAOV,OAAO,CAACG,IAAI,CAAC,CAAC,CAAE,yBAAwB,CAAC;EAC7DM,OAAO,CAACC,GAAG,CAAC,CAAC;EACbD,OAAO,CAACC,GAAG,CAAE,iDAAgD,CAAC;EAC9DD,OAAO,CAACC,GAAG,CAAE,2CAA0C,CAAC;EACxDV,OAAO,CAACwB,IAAI,CAAC,CAAC,CAAC;AACjB"}